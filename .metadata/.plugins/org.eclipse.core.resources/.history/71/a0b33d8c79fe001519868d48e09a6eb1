<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
</head>
<body>
<form method="post" action="/CabinetMedical/dbphp/main.php">
	<input style="float:right;" type="submit" name="medecin" value="Deconnexion">
</form> 
<?php
$tableHeaders;
$tableData;

require_once("DatabaseManager.php");
session_start ();
$userID = $_SESSION["userID"];
$DBManager = $_SESSION["DatabaseManager"];

$ret = $DBManager->runQuery("SELECT nom,prenom from Medecin WHERE medID='$userID';");
$row = pg_fetch_row($ret);
echo "Bonjour Dr. " . $row[1] . " " . $row[0];
?>
<h2>Consultations d'ajourd'hui</h2>
<?php 
$appointment = "SELECT heure, concat(' ', prenom, nom), duree FROM consultation NATURAL JOIN Patient WHERE medID='$userID' AND cdate";
$today = $appointment . "=current_date;";
$next = $appointment . ">current_date;";
$appointmentsToday = $DBManager->runQuery($today);
$appointmentsNext = $DBManager->runQuery($next);

if(pg_num_rows($appointmentsToday) == 0) {
	echo "Vous n'avez aucune consultation ajourd'hui.";
}
else {
	$tableHeaders = array("Heure", "Patient", "Duree");
	$tableData = $appointmentsToday;
	include("TableTemplate.php");
}
?>
<h2>Consultations prochaines</h2>
<?php
if(pg_num_rows($appointmentsNext) == 0) {
	echo "Vous n'avez aucunes consultations prochaines.";
}
else {
	$tableData = $appointmentsNext;
	include("TableTemplate.php");
}
?>
</body>
</html>